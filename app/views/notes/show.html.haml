.main-header
  = render 'main_header'
- if @note.is_draft && current_user?(@user)
  = render 'show_draft'
- else
  .note-show-container
    .note-show-container-wrapper
      - if @note.header_image.url
        .note-show-container__header-image{ style: "background-image: url('#{@note.header_image}')" }
      .note-show-container__user-name
        - if @user.image.url
          = link_to user_path(@user.noteid) do
            .note-show-container__profile-image{ style: "background-image: url('#{@user.image}')" }
        .note-show-container__profile
          %p{ style: 'font-weight: bold;' }
            = link_to @user.nickname, user_path(@user.noteid)
          %p{ style: 'color: #a1a6a9; font-size: 9px;' }
            = @note.created_at_jp
            - if current_user?(@user)
              %span
                = link_to '削除', @note, method: :delete
        - if current_user?(@user)
          = link_to edit_note_path(@note) do
            %button.note-show-container__setting-button
              編集
      .note-show-container__title
        = @note.title
      .note-show-container__body
        = @note.body
      .note-show-container__action{ style: "#{current_user.favorite?(@note) ? 'color: #EDC500;' : 'color: #898D8C;'}"}
        = render 'favorites/favorite_button', note: @note
        = @note.favorites.count
      .note-show-container__popular
        %p
          こちらもおすすめ
        %ul
          - @note.published.last(3).each do |note|
            %li
              = link_to note.title, note
      .note-show-container__pager
        - if @note.prev
          = link_to @note.prev do
            .note-show-container__pager-prev
              .fa.fa-chevron-left
              = @note.prev.title.truncate(20)
          - if @note.next
            = link_to @note.next do
              .note-show-container__pager-next
                = @note.next.title.truncate(20)
                .fa.fa-chevron-right
        - else
          - if @note.next
            = link_to @note.next do
              .note-show-container__pager-next-noprev
                = @note.next.title.truncate(20)
                .fa.fa-chevron-right
      .note-show-container__info
        .note-show-container__info-profile-wrapper
          - if @user.image.url
            = link_to user_path(@user.noteid) do
              .note-show-container__info-profile-image{ style: "background-image: url('#{@user.image}')" }
          .note-show-container__info-container
            .note-show-container__info-user-name
              = link_to @user.nickname, user_path(@user.noteid)
            .note-show-container__info-description
              = @user.description.truncate(100)
            - if user_signed_in?
              - unless current_user?(@user)
                .note-show-container__info-follow-button
                  = render 'users/follow', user: @user
      .note-show-container__comment
        .note-show-container__comment-count
          %span
            コメント
          = @comments.count
          %span
            件
        %ul.note-show-container__comment-list
          - @comments.each do |comment|
            %li
              - if comment.user.image.url
                = link_to user_path(comment.user.noteid) do
                  .comment-profile-image{ style: "background-image: url('#{comment.user.image}')" }
              .comment-container
                %p.comment-container__header
                  = link_to comment.user.nickname, user_path(comment.user.noteid), style: 'font-weight: bold'
                  &nbsp;
                  %span{ style: 'color: #a1a6a9; font-size: 9px;' }
                    = comment.created_at_jp
                %p.comment-container__body
                  = comment.text
        - if user_signed_in?
          = render 'comments/form', comment: @comment